---
title: Linux应用调试方法---Debug
date: 2017-12-20 23:07:24
categories: Linux内核
tags: [kernel, Debug]
---

常用的Linux应用调试方法：

<!--more-->
## strace

### 用法：

``` shell
strace ./a.out
```

## gdb

core dump
### 查看core设置

``` shell
ulimit -a
```

```
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 30956
max locked memory       (kbytes, -l) 16384
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 30956
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
```

### 开启core file

``` shell
ulimit -c unlimited
```

### 示例

> ubuntu18.04 64bit

* 异常程序(段错误)

``` C
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
    int *a;

    *a = 1;

    while(1)
    {

    }
    return EXIT_SUCCESS;
}
```
```
gcc -g test.c
```

* 运行异常程序后,生成core文件

* 使用gdb查看异常位置

``` shell
gdb ./a.out core
```
```
GNU gdb (Ubuntu 8.1-0ubuntu3) 8.1.0.20180409-git
Copyright (C) 2018 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from ./a.out...done.

warning: exec file is newer than core file.
[New LWP 20661]
Core was generated by `./a.out'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x0000563a00047609 in main (argc=1, argv=0x7ffe99b73178) at tst.c:8
8	    *a = 1;
```

### ARM平台

> 本地编译支持arm平台的gdb

``` shell
#!/bin/bash
PWD=`pwd`

mkdir tmp
cd tmp

if [ ! -f gdb-8.2.tar.gz ]; then
    wget http://101.110.118.57/ftp.gnu.org/gnu/gdb/gdb-8.2.tar.gz
fi

rm gdb-8.2 -rf
tar zxvf gdb-8.2.tar.gz

cd gdb-8.2

./configure --target=arm-linux --prefix=$PWD/_install  --enable-static
make -j2
make install

cd .. #gdb-8.2
cd .. #tmp
```

### gdb调试命令
